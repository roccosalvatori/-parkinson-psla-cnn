Dataset Statistics:
Total number of samples: 633
Sick samples: 235
Healthy samples: 398

First Dataset:
Total samples: 81
Sick: 40
Healthy: 41

Second Dataset:
Total samples: 552
Sick: 195
Healthy: 357

Samples by recording type:
B1: 49
B2: 49
D1: 35
D2: 35
FB1: 34
VA1: 35
VA2: 35
VE1: 35
VE2: 35
VI1: 35
VI2: 35
VO1: 35
VO2: 35
VU1: 35
VU2: 35

First batch shape: torch.Size([8, 1, 128, 1001])
First batch labels: tensor([0, 0, 0, 0, 1, 0, 0, 0])

Mel Spectrogram Details:
Shape: torch.Size([128, 1001])
Value range: [0.00, 1.00]
Mean: 0.16
Std: 0.28

Epoch 1/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.458  |       0.2581 |
+----------+------------+--------------+
| Accuracy |     0.7767 |       0.874  |
+----------+------------+--------------+

Epoch 2/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.3735 |       0.1942 |
+----------+------------+--------------+
| Accuracy |     0.8735 |       0.9291 |
+----------+------------+--------------+

Epoch 3/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.2823 |       0.1657 |
+----------+------------+--------------+
| Accuracy |     0.8913 |       0.937  |
+----------+------------+--------------+

Epoch 4/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.2275 |       0.2092 |
+----------+------------+--------------+
| Accuracy |     0.9269 |       0.9291 |
+----------+------------+--------------+

Epoch 5/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.2306 |       0.2841 |
+----------+------------+--------------+
| Accuracy |     0.9209 |       0.8898 |
+----------+------------+--------------+

Epoch 6/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.2273 |       0.123  |
+----------+------------+--------------+
| Accuracy |     0.9249 |       0.9449 |
+----------+------------+--------------+

Epoch 7/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.198  |       0.1756 |
+----------+------------+--------------+
| Accuracy |     0.9407 |       0.9528 |
+----------+------------+--------------+

Epoch 8/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.1827 |       0.07   |
+----------+------------+--------------+
| Accuracy |     0.9368 |       0.9606 |
+----------+------------+--------------+

Epoch 9/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.1357 |       0.1032 |
+----------+------------+--------------+
| Accuracy |     0.9565 |       0.9528 |
+----------+------------+--------------+

Epoch 10/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.1063 |       0.2903 |
+----------+------------+--------------+
| Accuracy |     0.9625 |       0.937  |
+----------+------------+--------------+

Epoch 11/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.1299 |       0.3754 |
+----------+------------+--------------+
| Accuracy |     0.9625 |       0.9213 |
+----------+------------+--------------+

Epoch 12/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.091  |       0.1353 |
+----------+------------+--------------+
| Accuracy |     0.9723 |       0.9528 |
+----------+------------+--------------+

Epoch 13/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.1639 |       0.1941 |
+----------+------------+--------------+
| Accuracy |     0.9466 |       0.937  |
+----------+------------+--------------+

Epoch 14/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0914 |        0.131 |
+----------+------------+--------------+
| Accuracy |     0.9664 |        0.937 |
+----------+------------+--------------+

Epoch 15/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0944 |       0.0787 |
+----------+------------+--------------+
| Accuracy |     0.9862 |       0.9685 |
+----------+------------+--------------+

Epoch 16/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0227 |       0.1016 |
+----------+------------+--------------+
| Accuracy |     0.9941 |       0.9685 |
+----------+------------+--------------+

Epoch 17/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0473 |       0.1314 |
+----------+------------+--------------+
| Accuracy |     0.9862 |       0.9449 |
+----------+------------+--------------+

Epoch 18/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0334 |       0.1135 |
+----------+------------+--------------+
| Accuracy |     0.9881 |       0.9606 |
+----------+------------+--------------+

Epoch 19/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0555 |       0.0418 |
+----------+------------+--------------+
| Accuracy |     0.9842 |       0.9764 |
+----------+------------+--------------+

Epoch 20/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0381 |       0.086  |
+----------+------------+--------------+
| Accuracy |     0.9901 |       0.9606 |
+----------+------------+--------------+

Epoch 21/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0272 |       0.1219 |
+----------+------------+--------------+
| Accuracy |     0.9921 |       0.9685 |
+----------+------------+--------------+

Epoch 22/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0381 |       0.1219 |
+----------+------------+--------------+
| Accuracy |     0.9862 |       0.9685 |
+----------+------------+--------------+

Epoch 23/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0249 |       0.1281 |
+----------+------------+--------------+
| Accuracy |     0.9941 |       0.9606 |
+----------+------------+--------------+

Epoch 24/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0268 |       0.0772 |
+----------+------------+--------------+
| Accuracy |     0.9921 |       0.9843 |
+----------+------------+--------------+

Epoch 25/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0232 |       0.0759 |
+----------+------------+--------------+
| Accuracy |     0.996  |       0.9764 |
+----------+------------+--------------+

Epoch 26/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.025  |       0.2284 |
+----------+------------+--------------+
| Accuracy |     0.9901 |       0.9449 |
+----------+------------+--------------+

Epoch 27/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0093 |       0.2128 |
+----------+------------+--------------+
| Accuracy |     0.996  |       0.9528 |
+----------+------------+--------------+

Epoch 28/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0508 |       0.0604 |
+----------+------------+--------------+
| Accuracy |     0.9921 |       0.9685 |
+----------+------------+--------------+

Epoch 29/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0311 |       0.0847 |
+----------+------------+--------------+
| Accuracy |     0.9941 |       0.9606 |
+----------+------------+--------------+

Epoch 30/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0219 |       0.1094 |
+----------+------------+--------------+
| Accuracy |     0.9921 |       0.9606 |
+----------+------------+--------------+

Epoch 31/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0148 |       0.0844 |
+----------+------------+--------------+
| Accuracy |     0.9941 |       0.9843 |
+----------+------------+--------------+

Epoch 32/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0051 |       0.0632 |
+----------+------------+--------------+
| Accuracy |     0.998  |       0.9764 |
+----------+------------+--------------+

Epoch 33/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0039 |       0.074  |
+----------+------------+--------------+
| Accuracy |     1      |       0.9685 |
+----------+------------+--------------+

Epoch 34/50
+----------+------------+--------------+
| Metric   |   Training |   Validation |
+==========+============+==============+
| Loss     |     0.0018 |       0.0982 |
+----------+------------+--------------+
| Accuracy |     1      |       0.9685 |
+----------+------------+--------------+
Early stopping triggered after 34 epochs

Evaluating on training set:

Evaluating on validation set:

Plotting metrics...

Training Set Metrics:
              precision    recall  f1-score   support

           0       1.00      1.00      1.00       328
           1       1.00      1.00      1.00       178

    accuracy                           1.00       506
   macro avg       1.00      1.00      1.00       506
weighted avg       1.00      1.00      1.00       506


Validation Set Metrics:
              precision    recall  f1-score   support

           0       0.96      1.00      0.98        70
           1       1.00      0.95      0.97        57

    accuracy                           0.98       127
   macro avg       0.98      0.97      0.98       127
weighted avg       0.98      0.98      0.98       127


All plots have been saved:
- training_history.png
- train_confusion_matrix.png
- val_confusion_matrix.png
- train_roc_curve.png
- val_roc_curve.png

Dataset Summary:
+------------+--------+--------------+-----------+
| Split      |   Size |   Batch Size |   Batches |
+============+========+==============+===========+
| Training   |    506 |            8 |        64 |
+------------+--------+--------------+-----------+
| Validation |    127 |            8 |        16 |
+------------+--------+--------------+-----------+

Model Summary:
+----------------------+------------+
| Parameter            | Value      |
+======================+============+
| Total Parameters     | 14,375,046 |
+----------------------+------------+
| Trainable Parameters | 14,375,046 |
+----------------------+------------+
| Learning Rate        | 0.000075   |
+----------------------+------------+
| Device               | cpu        |
+----------------------+------------+



=== System Information ===
+-----------------+-------------------+
| Parameter       | Value             |
+=================+===================+
| PyTorch Version | 2.6.0.dev20241121 |
+-----------------+-------------------+
| CUDA Available  | False             |
+-----------------+-------------------+
| CUDA Device     | N/A               |
+-----------------+-------------------+
| Device          | cpu               |
+-----------------+-------------------+

=== Model Architecture Parameters ===
+-------------------------------+-----------------+
| Parameter                     | Value           |
+===============================+=================+
| Backbone                      | EfficientNet-B2 |
+-------------------------------+-----------------+
| Backbone Channels             | 1408            |
+-------------------------------+-----------------+
| Attention Heads               | 4               |
+-------------------------------+-----------------+
| Backbone Dropout              | 0.3             |
+-------------------------------+-----------------+
| Path Dropout                  | 0.2             |
+-------------------------------+-----------------+
| Spatial Dropout               | 0.3             |
+-------------------------------+-----------------+
| Classifier Hidden Size        | 512             |
+-------------------------------+-----------------+
| First Classifier Dropout      | 0.5             |
+-------------------------------+-----------------+
| Subsequent Classifier Dropout | 0.3             |
+-------------------------------+-----------------+
| Total Parameters              | 14,375,046      |
+-------------------------------+-----------------+
| Trainable Parameters          | 14,375,046      |
+-------------------------------+-----------------+

Loading model weights from 'best_model.pth'...

=== Audio Preprocessing Parameters ===
+---------------------+---------------------------+
| Parameter           | Value                     |
+=====================+===========================+
| Sample Rate         | 16000                     |
+---------------------+---------------------------+
| Number of Mel Bands | 128                       |
+---------------------+---------------------------+
| FFT Size            | 2048                      |
+---------------------+---------------------------+
| Hop Length          | 160                       |
+---------------------+---------------------------+
| Window Length       | 400                       |
+---------------------+---------------------------+
| Frequency Range     | 0-8000Hz                  |
+---------------------+---------------------------+
| Power               | 2.0                       |
+---------------------+---------------------------+
| Recording Configs   |                           |
+---------------------+---------------------------+
| default Config      | Length: 5s, Frames: 501   |
+---------------------+---------------------------+
| B Config            | Length: 10s, Frames: 1001 |
+---------------------+---------------------------+
| D Config            | Length: 5s, Frames: 501   |
+---------------------+---------------------------+
| FB Config           | Length: 8s, Frames: 801   |
+---------------------+---------------------------+
| V Config            | Length: 3s, Frames: 301   |
+---------------------+---------------------------+

Preparing dataset...

=== Dataset Configuration ===
+-------------------+---------+
| Parameter         |   Value |
+===================+=========+
| Total Samples     |      81 |
+-------------------+---------+
| Batch Size        |       8 |
+-------------------+---------+
| Number of Batches |      11 |
+-------------------+---------+
| Shuffle           |   False |
+-------------------+---------+
| Number of Workers |       0 |
+-------------------+---------+

Running evaluation...
Processing batches: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:06<00:00,  1.60it/s]

Generating visualizations...

Classification Report:
              precision    recall  f1-score   support

     Healthy       0.93      1.00      0.96        41
          PD       1.00      0.93      0.96        40

    accuracy                           0.96        81
   macro avg       0.97      0.96      0.96        81
weighted avg       0.97      0.96      0.96        81


Confidence Analysis:
Healthy predictions - Mean: 0.005 ± 0.025
PD predictions - Mean: 0.921 ± 0.238

Misclassified samples: 3 (3.70%)

=== Detailed Performance Metrics ===
+------------------------+-----------+
| Metric                 | Value     |
+========================+===========+
| Accuracy               | 0.963     |
+------------------------+-----------+
| ROC AUC                | 0.996     |
+------------------------+-----------+
| Misclassification Rate | 0.037     |
+------------------------+-----------+
| Total Samples          | 81        |
+------------------------+-----------+
| Misclassified Samples  | 3 (3.70%) |
+------------------------+-----------+

=== Class-Specific Metrics ===
+-----------------+---------------+----------+
| Metric          |   Healthy (0) |   PD (1) |
+=================+===============+==========+
| Samples         |        41     |   40     |
+-----------------+---------------+----------+
| Mean Confidence |         0.005 |    0.921 |
+-----------------+---------------+----------+
| Confidence Std  |         0.025 |    0.238 |
+-----------------+---------------+----------+

Evaluation complete! Check the generated visualization files:
1. confusion_matrix.png
2. roc_curve.png
3. pr_curve.png
4. confidence_dist.png